<!DOCTYPE html>
<html>
<head>
    <title>DeepSeek Message Portal</title>
    <style>
        body { max-width: 800px; margin: 20px auto; padding: 20px; }
        .section { margin-bottom: 30px; border: 1px solid #ddd; padding: 20px; }
        textarea { width: 100%; height: 100px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>DeepSeek Message Portal</h1>

    <div class="section">
        <h2>发送消息</h2>
        <form onsubmit="return false;">
            <input type="text" name="username" placeholder="用户名" required>
            <textarea name="message" placeholder="输入你的消息..." required></textarea>
            <button onclick="saveMessage()">保存消息</button>
        </form>
        <p id="saveStatus"></p>
    </div>

    <div class="section">
        <h2>咨询DeepSeek</h2>
        <form onsubmit="return false;">
            <textarea id="question" placeholder="输入你的问题..." required></textarea>
            <button onclick="askDeepSeek()">提问</button>
        </form>
        <div id="answer"></div>
    </div>

    <script>
        async function saveMessage() {
            const formData = new FormData(document.forms[0])
            const response = await fetch('/', {
                method: 'POST',
                body: new URLSearchParams(formData)
            })
            document.getElementById('saveStatus').textContent = '消息保存成功！'
            setTimeout(() => {
                document.getElementById('saveStatus').textContent = ''
            }, 2000)
        }

        async function askDeepSeek() {
            const question = document.getElementById('question').value
            const response = await fetch('/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({ question })
            })
            const data = await response.json()
            document.getElementById('answer').innerHTML = `
                <h3>回答：</h3>
                <p>${data.answer.replace(/\n/g, '<br>')}</p>
            `
        }
    </script>
</body>
</html>